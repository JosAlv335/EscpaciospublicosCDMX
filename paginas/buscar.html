<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscar</title>
    <link rel="stylesheet" href="../assets/css/buscar.css">
</head>
<body>
    <header>
        <h1>Buscar</h1>
    </header>
    <main>
        
        <script src = "../assets/js/showTableResults.js"></script>

        <div class="form-group">
            <label for="nombre">Nombre:</label>
            <input type="text" id="campoBusqueda" name="nombre">
        </div>
            
        <div class="contenedor-tabla">
            <div id="resultado-busqueda"></div>
        </div>

        <div class="button-group">
            <a href="../paginas/tabla.html" class="cancel-button">Regresar</a>
        </div>
    </main>
    <script>
        const SUPABASE_REST_URL = process.env.REST_URL;
const SUPABASE_REST_KEY = process.env.REST_PUBLIC_KEY;

async function showSearchResults(busqueda){


try {

    const main_url = SUPABASE_REST_KEY + "/rest/v1"

    const request_url = main_url + "/parques?nombre=ilike.${busqueda}%";

    const response = await fetch(request_url);

    if(!response.ok){
        throw new Error('No matches found...');
    }

    //Obtener los datos de la respuesta
    const data = await response.json();

    //Limpiar la tabla de resultados
    const tablaResultados = document.getElementById('resultado-busqueda');
    const tbody = tablaResultados.querySelector('tbody');
    tbody.innerHTML = "";

    // Agregar los resultados a la tabla
    data.forEach(parque => {
        const fila = `
            <tr>
                <td>${parque.id}</td>
                <td>${parque.nombre}</td>
                <td>${parque.direccion}</td>
                <td>${parque.ciudad}</td>
            </tr>
        `;
        tbody.innerHTML += fila;
    });
} catch (error) {
    console.error('Error:', error);
}

}


        document.getElementById('campoBusqueda').addEventListener('input',function(){

            const busqueda = this.value.trim();

            showSearchResult(busqueda);

        })

    </script>
</body>
</html>